@page "/direct/{directId:guid}"

<MudStack Justify="Justify.SpaceBetween" Row="false" Style="height: 100%">
    <MudPaper Style="padding: 20px; position: sticky">
        <MudStack AlignItems="AlignItems.Center" Justify="Justify.SpaceBetween" Row="true">
            <MudStack Row="true" Spacing="5" AlignItems="AlignItems.Center">
                @if (DirectDto.Avatars != null && DirectDto.Avatars.Count > 0)
                {
                    <MudAvatar Color="Color.Primary">
                        <MudImage Src="@($"data:image/png;base64, {Image}")"/>
                    </MudAvatar>
                }
                @if (DirectDto.Avatars == null || DirectDto.Avatars.Count == 0)
                {
                    <MudAvatar Color="Color.Primary">
                        @DirectDto.FirstName?[0]
                    </MudAvatar>
                }
                <MudText>
                    @DirectDto.FirstName @DirectDto.LastName
                </MudText>
            </MudStack>
            <MudStack>
                <MudIconButton Icon="@Icons.Material.Filled.MoreVert" Color="Color.Info"/>
            </MudStack>
        </MudStack>
    </MudPaper>
    <MudStack Reverse="true" Row="false" style="height: 80%; overflow-y: auto">
        @for (int i = 0; i < 10; i++)
        {
            var i1 = i;
            <MudPaper Style="padding: 20px;" Class="mb-4">
                @i1
            </MudPaper>
        }
    </MudStack>
    <MudPaper Style="padding: 20px; position: sticky;">
        <MudStack AlignItems="AlignItems.Center" Row="true">
            <MudTextField T="string" Variant="Variant.Filled" @bind-Text="Input" Lines="3"/>
            <MudFileUpload T="IBrowserFile" OnFilesChanged="SetFiles" multiple>
                <ButtonTemplate>
                    <MudIconButton HtmlTag="label"
                                   Size="Size.Large"
                                   Icon="@Icons.Material.Filled.Attachment"
                                   Style="rotate: 90deg"
                                   for="@context.Id"/>
                </ButtonTemplate>
            </MudFileUpload>
            <MudIconButton Color="Color.Primary" 
                           OnClick="@(async () => await DirectService.AddMessageAsync(DirectId, Input, Files))" 
                           Size="Size.Large" Icon="@Icons.Material.Filled.Send"/>
        </MudStack>
    </MudPaper>
</MudStack>